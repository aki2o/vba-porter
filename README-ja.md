これは何？
==========

Excelのアドインです。  
Visual Basic EditorのVBAコンポーネント(標準モジュール/クラスモジュール/フォームモジュール)の
インポート/エクスポートを実施するメニューを提供します。


特徴
====

### メニューから独自コンポーネントのインポート/エクスポート

以下のメニューで独自コンポーネントのインポート/エクスポートができます。

![defaultmenu](img/defaultmenu-ja.png)

※インポートするには、'更新'を押します。  
※エクスポートするには、'保存'を押します。  
※インポートを実行すると、vba-porter.xlaのVBAプロジェクトのコンポーネントは一旦全て削除されます。  

### メニューから独自コンポーネントの関数を実行

インポートされたコンポーネントから以下のような独自メニューが生成され、
コンポーネントの関数を実行できます。

![yourmenu](img/yourmenu-ja.png)

#### 独自メニュー生成の条件

独自メニューを生成するためには、以下の条件を満たす必要があります。

* 'Click'という名前のPublicなSubを定義する。(メニュー押下時、この関数が実行されます)
* ファイルの先頭に、コメントでメニュー名を定義する。

```vb
'VBAPorter:MenuName=MyMenu 01
Public Sub Click()
End Sub
```

※詳しくは、'sample'ディレクトリを参照して下さい。  
※メニューは上記条件を満たした標準モジュールからのみ生成されます。  

### エクスポート先のファイル変更を検知

インポート後、あなたがVisual Basic EditorでVBA開発している時、  
他のプログラム(例えば、SVN)がエクスポート先のファイルを変更することがあるかも知れません。  
その場合には、エクスポートの際に以下のようなダイアログを表示しますので、  
該当のコンポーネントをエクスポートするかどうか選択できます。

![confirmexport](img/confirmexport-ja.png)


インストール
============

1. vba-porter.xlaをダウンロードします。

2. Excelのメニューバーの'ツール - アドイン'を選択します。

3. 表示されたダイアログの参照ボタンをクリックします。

    ![install1](img/install1.png)

4. ダウンロードしたvba-porter.xlaを選択します。

    ![install2](img/install2.png)

5. 以下のようにVba-Porterが選択されていることを確認して、OKをクリックします。

    ![install3](img/install3.png)

6. ExcelのメニューバーにVBAPorterができたことを確認します。

    ![install4](img/install4.png)


設定
====

ホームディレクトリに設定ファイルを配置する必要があります。  
ファイル名は、'.vbaporter'か'_vbaporter'です。  
ファイル形式は、WindowsのINI形式です。  
以下のように、コンポーネントが存在する場所毎にセクションを定義して下さい。

```ini
[MyProj]
; セクション名は任意の文字列です。但し、セクション間でユニークにして下さい。

ROOT=D:\Work\SampleProj\src
; ROOTはコンポーネントが存在するルートディレクトリの絶対パスです。
; コンポーネントは、このディレクトリ配下から再帰的に検索されます。

MENUNAME=SampleProject
; MENUNAMEはROOT配下のコンポーネントから生成される独自メニューのルートメニュー名です。
; もし、このコンポーネントからメニューを生成しない場合は、この値は設定しないで下さい。
; 子メニューのメニュー名は、そのコンポーネントのディレクトリ名が使われます。
```

※'conf'ディレクトリにサンプルがあります。  


動作確認
========

* Windows ... Windows XP SP3
* Excel ... Excel 2003 SP3


**Enjoy!!!**

